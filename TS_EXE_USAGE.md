# ts.exe 使用方法

本文档说明如何使用由 `ts.py` 打包生成的 `ts.exe` 程序。

## 一、文件准备

将打包生成的 `dist/ts.exe` 复制到你的工作目录。

**重要**：`ts.exe` 在运行时需要 `config.yaml` 文件来获取配置（如视频目录、日志路径等）。
- 如果打包时已将 `config.yaml` 包含进去，则无需额外文件。
- 如果要**覆盖**内置的配置，或打包时未包含，请将一个有效的 `config.yaml` 文件放置在与 `ts.exe` **相同的目录**下。

目录结构示例：
```
/my_bili_task/
|-- ts.exe
|-- config.yaml
|-- (其他如 up.exe 等)
```

## 二、执行方式

打开 PowerShell 或 CMD 命令行，进入 `ts.exe` 所在的目录。

### 方式1：立即执行一次

直接运行程序，它会执行一次 `main` 函数中定义的任务。

```powershell
.\ts.exe
```

### 方式2：每日定时执行（常驻模式）

使用 `--daily` 参数启动程序，它会进入一个循环等待的状态，在每天指定的时间执行一次任务。

**注意：** 此模式下，命令行窗口会保持运行不退出。

#### 示例1：每天 03:00 执行 (默认)

```powershell
.\ts.exe --daily
```
程序启动后，会计算并显示下一次在凌晨 3 点的执行时间，然后静默等待。

#### 示例2：每天指定时间执行 (例如 02:30)

使用 `--time` 参数可以自定义执行时间。

```powershell
.\ts.exe --daily --time 02:30
```
这会使程序在每天的 02:30 执行任务。

## 三、查看日志

- **任务日志**: `main` 函数执行过程中产生的日志，其路径由 `config.yaml` 文件中的 `paths.log_file1` 定义。
- **调度日志**: 在 `--daily` 模式下，关于等待、下次执行时间等调度信息会直接输出到**控制台**，并同时记录在 `main` 函数的日志文件中。

要查看程序是否正常运行，可以观察控制台输出或检查对应的日志文件。

## 四、停止常驻程序

在运行 `ts.exe --daily` 的命令行窗口中，按 `Ctrl + C` 可以终止程序。
